<!DOCTYPE html>
<html>
  <head>
    <title>Adding Web Map Interactions</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.0/dist/leaflet.css"/>




    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        width: 100%;
        height: 100%;
      }
      .legend {
z-index: 1000;
position: absolute;
right: 20px;
bottom: 20px;
padding: 6px 8px;
font: 14px Arial, Helvetica, sans-serif;
background: white;
background: rgba(255, 255, 255, 0.8);
box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
border-radius: 5px;
}
.legend i {
width: 18px;
height: 16px;
float: left;
margin-right: 8px;
opacity: 0.7;
}
    </style>




    <!-- JS Libraries -->
    <script src="https://unpkg.com/leaflet@1.7.0/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/1.3.4/chroma.min.js"></script>




  </head>
  <body>
    <div id="map"></div>


<div class='legend'></div>
   <script>
  var map = L.map('map').setView([37.8, -96], 5);


  // Add basemap
  L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="https://carto.com/">CARTO</a>',
    subdomains: 'abcd',
    maxZoom: 19
  }).addTo(map);


 
  var grades = [0, 10, 20, 50, 100, 200, 500, 1000];
  var colors = chroma.scale('YlOrBr').colors(grades.length);

  function getColor(d) {
    for (var i = 0; i < grades.length - 1; i++) {
      if (d > grades[i] && d <= grades[i + 1]) return colors[i];
    }
    if (d > grades[grades.length - 1]) return colors[grades.length - 1];
    return '#CCCCCC'; // default for missing data
  }


 
  $.when(
    $.getJSON("assets/us-states.geojson"),
    $.getJSON("assets/csv.json")
  ).done(function(geoData, fireData) {


    // Step 1: Create lookup object from csv.json
    var fireLookup = {};
    fireData[0].forEach(function(item) {
      fireLookup[item.name] = item;
    });


    // Step 2: Create GeoJSON layer with dynamic style and popup
    var geojsonLayer = L.geoJson(geoData[0], {
      style: function(feature) {
        var name = feature.properties.name;
        var record = fireLookup[name];
        var value = record ? record.acres_burned_per_fire : 0;
        return {
          weight: 2,
          opacity: 1,
          color: 'grey',
          dashArray: '3',
          fillOpacity: 0.7,
          fillColor: getColor(value)
        };
      },
      onEachFeature: function(feature, layer) {
        var name = feature.properties.name;
        var record = fireLookup[name];
        if (record) {
          layer.bindPopup(
            "<strong>" + name + "</strong><br>" +
            "Acres burned per fire: " + record.acres_burned_per_fire.toLocaleString()
          );
        } else {
          layer.bindPopup("<strong>" + name + "</strong><br>No data");
        }
      }
    }).addTo(map);
var labels = [];
for (var i = 0; i < grades.length - 1; i++) {
labels.push('<i style="background:' + colors[i] +
'"></i> ' + grades[i] + ' - ' + grades[i + 1]);
}
labels.push('<i style="background:' + colors[grades.length - 1] +
'"></i> ' + grades[grades.length - 1] + ' +');
$(".legend").html(labels.join('<br>'));
  }).fail(function(err) {
    console.error("Error loading data:", err);
  });
 
</script>
  </body>
</html>


